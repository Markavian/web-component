<!DOCTYPE html>
<html>

<head>
  <title>Web Component Examples - Monitor Status Debug</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.3/handlebars.js"></script>
  <script src="../lib/web-component.js"></script>

  <!-- All the boostrap theming -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

  <!-- Code highlighting support -->
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>

  <style for="page">
    body {
      padding: 20px;
      font-family: sans-serif;
    }
  </style>

</head>

<body>
  <h1>Create a Web Component</h1>
  <p>This form helps you create a standalone Java Script include you use to develop your own web components. Your web component is then in a form that can then be included from anywhere on the web.</p>
  <create-a-web-component></create-a-web-component>

  <!-- Define the web component that drives this page -->
  <template for="create-a-web-component" template-id="default">
    <div class="panel panel-default">
      <div class="panel-heading">Live Preview</div>
      <div class="panel-body">
        <div class="row">
          <div class="col-md-6">
            <live-preview-form data-target-id="live-preview-form-{{template-id}}"></live-preview-form>
          </div>
          <div class="col-md-6">
            <live-preview-output template-id="live-preview-form-{{template-id}}"></live-preview-output>
          </div>
        </div>
      </div>
    </div>
      <div class="row">
        <div class="col-md-6">
          <template-form></template-form>
          <javascript-form></javascript-form>
          <stylesheet-form></styesheet>
        </div>
        <div class="col-md-6">
          <web-component-output></web-component-output>
        </div>
      </div>
  </template>

  <template for="live-preview-form">
    <form>
      <div class="form-group">
        <textarea type="text" class="form-control" id="live-preview-form" placeholder="Type here: <my-component></my-component>" rows="12"></textarea>
      </div>
    </form>
  </template>

  <style for="live-preview-form">
    live-preview-form > form > div > textarea {
      font-family: monospace;
    }
  </style>

  <script type="text/javascript">
  $(function() {
    var LivePreviewForm = Component.configure("live-preview-form");

    function catchTab(e) {
      if (e.keyCode == 9) {
      	var myValue = "\t";
      	var startPos = this.selectionStart;
      	var endPos = this.selectionEnd;
      	var scrollTop = this.scrollTop;
      	this.value = this.value.substring(0, startPos) + myValue + this.value.substring(endPos,this.value.length);
      	this.focus();
      	this.selectionStart = startPos + myValue.length;
      	this.selectionEnd = startPos + myValue.length;
      	this.scrollTop = scrollTop;

      	e.preventDefault();
      }
    }

    LivePreviewForm.on("renderComplete", function(instance) {
      var dataTargetId = instance["data-target-id"];
      var dataTarget = $('#' + dataTargetId);

      $('textarea', instance.element).bind('input propertychange', function() {
        dataTarget.html($(this).val())

        var scope = dataTarget[0];
        Component.registerTemplates(scope).scanForComponents(scope);
      });
      $(instance.element).on('keydown', 'textarea', catchTab);
    });

    LivePreviewForm.apply(function(instance) {
      instance.render();
    });
  });
  </script>

  <template for="live-preview-output">
    <div id="{{template-id}}">
      <p>Content preview goes here.</p>
    </div>
  </template>


</body>
</html>
